<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>
		<script type="text/javascript" src="https://s3.amazonaws.com/ais_libraries/BaseJS/2.0/base.min.js"></script>
		<link rel="stylesheet" type="text/css" href="https://ais.quickbase.com/db/bjbsgxy2r?a=dbpage&pageID=4">

		<script>
			var demoApp = angular.module('demoApp', []);
			
			demoApp.controller('DemoAppCtrl', function ($scope) {
				var demoDbid = "bjbsgxy3t";
				
				//Initiate connection to application
				var client = new Base("cgfsmfcdc5vyp5k5s7h6b6v3m9v");

				//Get Ticket
				var ticket = client.getTicket();
				console.log("TICKET: " + ticket);

				var variable = client.setVar("bjbsgxy2r", "test", "hello world");
				console.log("SET VAR: " + variable);
				var variableValue = client.getVar("bjbsgxy2r", "test");
				console.log("GET VAR: " + variableValue);

				//Get User Info
				var response = client.getUserInfo();
				console.log("USER INFO: " + response);

				//Add Record
				var newRecordHash = { 8: "Mike", 9: "Johnson", 14: "4", 15: "2pm" }
				var rid = client.addRecord(demoDbid, newRecordHash);
				console.log("ADD RECORD: " + rid);

				var newRecordHash = { 8: "Mike", 9: "Johnson", 14: "5", 15: "3pm" }
				var rid2 = client.addRecord(demoDbid, newRecordHash);

				//Edit Record
				var editRecordHash = { 8: "Stephan", 9: "Smith" }
				var response = client.editRecord(demoDbid, rid, editRecordHash);
				console.log("EDIT RECORD: " + response);

				//Find
				var response = client.find(demoDbid, rid);
				console.log("FIND: " + response);

				var response = client.find(demoDbid, [rid, rid2]);
				console.log("FIND 2: " + response);

				var response = client.first(demoDbid, "{'3'.XEX.''}", "3");
				console.log("FIRST: " + response);

				var response = client.last(demoDbid, "{'3'.XEX.''}", "3");
				console.log("LAST: " + response);
				//DoQuery
				var query = "{'3'.XEX.''}"
				var response = client.doQuery(demoDbid, {"query": query})
				console.log("QUERY 1: " + response);

				var qid = "1"
				var response = client.doQuery(demoDbid, {"qid": qid, "clist": ["1", "2", "3", "4", "5", "14", "15"]})
				console.log("QUERY 2: " + response);

				var response = client.all(demoDbid);
				console.log("ALL: " + response);

				var dateCreated = BaseHelpers.dateToString(response[0]["1"]);
				var dateModified = BaseHelpers.dateTimeToString(response[0]["2"]);
				var totalHours = BaseHelpers.durationToString(response[0]["14"]);
				var timeOfDay = BaseHelpers.timeOfDayToString(response[0]["15"]);

				console.log("DATE CREATED: " + dateCreated);
				console.log("DATE MODIFIED: " + dateModified);
				console.log("TOTAL HOURS: " + totalHours);
				console.log("TIME OF DAY: " + timeOfDay);

				//DoQueryCount
				var query = "{'3'.XEX.''}"
				var response = client.doQueryCount(demoDbid, query)
				console.log("DO QUERY COUNT: " + response);

				//Delete Record
				var response = client.deleteRecord(demoDbid, rid);
				console.log("DELETE: " + response);

				var csvArray = [
					{ 8: 'Mike"s', 9: "John>s&o<n" },
					{ 8: "Step,hani'e", 9: "Wallace" },
					{ 8: "Jackson", 9: "Williams" },
					{ 8: "Martin", 9: "Douglas" }
				]
				var response = client.importRecords(demoDbid, csvArray);
				console.log("IMPORT: " + response);

				//Delete Mass Records
				var response = client.purgeRecords(demoDbid, "{'3'.XEX.''}")
				console.log("PURGE: " + response);

				//Get Table Fields
				var response = client.getTableFields(demoDbid);
				console.log("GET TABLE FIELDS: " + response);

				//ASYNC
				var asyncClient = new Base("cgfsmfcdc5vyp5k5s7h6b6v3m9v", true);

				//Get Ticket
				asyncClient.getTicket(function(response){
					console.log("TICKET: " + response);
				});

				asyncClient.setVar("bjbsgxy2r", "test", "hello world", function(response){
					console.log("SET VAR: " + response);
				});

				asyncClient.getVar("bjbsgxy2r", "test", function(response){
					console.log("GET VAR: " + response)
				});

				//Get User Info
				asyncClient.getUserInfo("", function(response){
					console.log("USER INFO: " + response);
				});

				//Add Record
				var newRecordHash = { 8: "Mike", 9: "Johnson", 14: "4", 15: "2pm" }
				asyncClient.addRecord(demoDbid, newRecordHash, function(rid){
					console.log("ADD RECORD: " + rid);

					//Edit Record
					var editRecordHash = { 8: "Stephan", 9: "Smith" }
					asyncClient.editRecord(demoDbid, rid, editRecordHash, function(response){
						console.log("EDIT RECORD: " + response);
					});
				});

				//Find
				asyncClient.find(demoDbid, rid, function(response){
					console.log("FIND: " + response);
				});
				
				asyncClient.find(demoDbid, [rid, rid2], function(response){
					console.log("FIND 2: " + response);
				});
				
				asyncClient.first(demoDbid, "{'3'.XEX.''}", "3", function(response){
					console.log("FIRST: " + response);
				});
				
				asyncClient.last(demoDbid, "{'3'.XEX.''}", "3", function(response){
					console.log("LAST: " + response);
				});

				//DoQuery
				var query = "{'3'.XEX.''}"
				asyncClient.doQuery(demoDbid, {"query": query}, function(response){
					console.log("QUERY 1: " + response);
				});

				var qid = "1"
				asyncClient.doQuery(demoDbid, {"qid": qid, "clist": ["1", "2", "3", "4", "5", "14", "15"]}, function(response){
					console.log("QUERY 2: " + response);
				});

				asyncClient.all(demoDbid, null, function(response){
					console.log("ALL: " + response);
				});

				//DoQueryCount
				var query = "{'3'.XEX.''}"
				client.doQueryCount(demoDbid, query, function(response){
					console.log("DO QUERY COUNT: " + response);
				});

				//Delete Record
				client.deleteRecord(demoDbid, rid, function(response){
					console.log("DELETE: " + response);
				});
				
				var csvArray = [
					{ 8: 'Mike"s', 9: "John>s&o<n" },
					{ 8: "Step,hani'e", 9: "Wallace" },
					{ 8: "Jackson", 9: "Williams" },
					{ 8: "Martin", 9: "Douglas" }
				]
				client.importRecords(demoDbid, csvArray, function(response){
					console.log("IMPORT: " + response);
				});
				
				//Delete Mass Records
				client.purgeRecords(demoDbid, "{'3'.XEX.''}", function(response){
					console.log("PURGE: " + response);
				});

				//Get Table Fields
				client.getTableFields(demoDbid, function(response){
					console.log("GET TABLE FIELDS: " + response);
				});
			});
		</script>
	</head>

	<body ng-app="demoApp">
		<div class="container">
			<br>
			<div ng-controller="DemoAppCtrl">
				<table class="table table-bordered">
			</div>
		</div>
	</body>
</html>